2020-10-20 03:26:05.221811 (MainThread): Running with dbt=0.18.1
2020-10-20 03:26:05.488907 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-10-20 03:26:05.523061 (MainThread): Tracking: tracking
2020-10-20 03:26:05.523260 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10686978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b106860f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10686940>]}
2020-10-20 03:26:05.523581 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=14
2020-10-20 03:26:05.524067 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-10-20 03:26:05.524406 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-10-20 03:26:05.532844 (Thread-1): Parsing macros/adapters.sql
2020-10-20 03:26:05.564484 (Thread-1): Parsing macros/catalog.sql
2020-10-20 03:26:05.566541 (Thread-1): Parsing macros/materializations/table.sql
2020-10-20 03:26:05.570571 (Thread-1): Parsing macros/materializations/merge.sql
2020-10-20 03:26:05.572626 (Thread-1): Parsing macros/materializations/view.sql
2020-10-20 03:26:05.574188 (Thread-1): Parsing macros/materializations/incremental.sql
2020-10-20 03:26:05.584480 (Thread-1): Parsing macros/core.sql
2020-10-20 03:26:05.588322 (Thread-1): Parsing macros/adapters/common.sql
2020-10-20 03:26:05.632524 (Thread-1): Parsing macros/materializations/helpers.sql
2020-10-20 03:26:05.641840 (Thread-1): Parsing macros/materializations/table/table.sql
2020-10-20 03:26:05.649275 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-10-20 03:26:05.670636 (Thread-1): Parsing macros/materializations/view/view.sql
2020-10-20 03:26:05.677110 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 03:26:05.682336 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 03:26:05.684286 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 03:26:05.690750 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-10-20 03:26:05.705229 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 03:26:05.722668 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 03:26:05.724540 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 03:26:05.753761 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-10-20 03:26:05.755784 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-10-20 03:26:05.757483 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-10-20 03:26:05.759325 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 03:26:05.762217 (Thread-1): Parsing macros/etc/get_custom_database.sql
2020-10-20 03:26:05.763987 (Thread-1): Parsing macros/etc/query.sql
2020-10-20 03:26:05.765120 (Thread-1): Parsing macros/etc/datetime.sql
2020-10-20 03:26:05.774275 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-10-20 03:26:05.775296 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-10-20 03:26:05.777019 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-10-20 03:26:05.840060 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:26:05.871423 (Thread-1): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 03:26:05.891796 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:26:05.910284 (Thread-1): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:26:05.924865 (Thread-1): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 03:26:05.944000 (Thread-1): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 03:26:05.961671 (Thread-1): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 03:26:05.979514 (Thread-1): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 03:26:05.997079 (Thread-1): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 03:26:06.016265 (Thread-1): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 03:26:06.035646 (Thread-1): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 03:26:06.786674 (Thread-2): handling status request
2020-10-20 03:26:06.787225 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104d1c50>]}
2020-10-20 03:26:06.792987 (Thread-2): sending response (<Response 11345 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:28.123465 (Thread-3): handling status request
2020-10-20 03:27:28.124230 (Thread-4): handling status request
2020-10-20 03:27:28.125414 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1036b7f0>]}
2020-10-20 03:27:28.125791 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1037e5c0>]}
2020-10-20 03:27:28.130405 (Thread-3): sending response (<Response 11345 bytes [200 OK]>) to 10.0.47.166
2020-10-20 03:27:28.135260 (Thread-4): sending response (<Response 11345 bytes [200 OK]>) to 10.0.22.169
2020-10-20 03:27:28.561626 (Thread-5): handling cli_args request
2020-10-20 03:27:28.562118 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1030f358>]}
2020-10-20 03:27:28.572485 (Thread-5): Connection 'model.citibike.nhood_json' was properly closed.
2020-10-20 03:27:29.667466 (Thread-5): sending response (<Response 137 bytes [200 OK]>) to 10.0.1.193
2020-10-20 03:27:29.756328 (MainThread): Partial parsing not enabled
2020-10-20 03:27:29.757721 (MainThread): Parsing macros/adapters.sql
2020-10-20 03:27:29.788443 (MainThread): Parsing macros/catalog.sql
2020-10-20 03:27:29.790645 (MainThread): Parsing macros/materializations/table.sql
2020-10-20 03:27:29.794725 (MainThread): Parsing macros/materializations/merge.sql
2020-10-20 03:27:29.796909 (MainThread): Parsing macros/materializations/view.sql
2020-10-20 03:27:29.799167 (MainThread): Parsing macros/materializations/incremental.sql
2020-10-20 03:27:29.810139 (MainThread): Parsing macros/core.sql
2020-10-20 03:27:29.814424 (MainThread): Parsing macros/adapters/common.sql
2020-10-20 03:27:29.858823 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-20 03:27:29.868310 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-20 03:27:29.875386 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-20 03:27:29.897065 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-20 03:27:29.903687 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 03:27:29.909055 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 03:27:29.911059 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 03:27:29.917509 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-20 03:27:29.931959 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 03:27:29.949226 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 03:27:29.951160 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 03:27:29.980445 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-20 03:27:29.982576 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-20 03:27:29.984294 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-20 03:27:29.986173 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 03:27:29.989048 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-20 03:27:29.990837 (MainThread): Parsing macros/etc/query.sql
2020-10-20 03:27:29.991989 (MainThread): Parsing macros/etc/datetime.sql
2020-10-20 03:27:30.001183 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-20 03:27:30.002245 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-20 03:27:30.003988 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-20 03:27:30.015128 (MainThread): Partial parsing not enabled
2020-10-20 03:27:30.066546 (MainThread): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:27:30.089685 (Thread-6): handling poll request
2020-10-20 03:27:30.090183 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10342048>]}
2020-10-20 03:27:30.096009 (Thread-6): sending response (<Response 9071 bytes [200 OK]>) to 10.0.7.71
2020-10-20 03:27:30.097067 (MainThread): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 03:27:30.117567 (MainThread): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:27:30.135878 (MainThread): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:27:30.150293 (MainThread): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 03:27:30.168771 (MainThread): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 03:27:30.186626 (MainThread): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 03:27:30.204554 (MainThread): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 03:27:30.222216 (MainThread): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 03:27:30.241142 (MainThread): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 03:27:30.260345 (MainThread): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 03:27:30.543446 (MainThread): Found 11 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources
2020-10-20 03:27:30.544812 (MainThread): 
2020-10-20 03:27:30.545201 (MainThread): Acquiring new snowflake connection "master".
2020-10-20 03:27:30.551558 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_citibike".
2020-10-20 03:27:30.565124 (ThreadPoolExecutor-0_0): Using snowflake connection "list_citibike".
2020-10-20 03:27:30.565218 (ThreadPoolExecutor-0_0): On list_citibike: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_citibike"} */

    show terse schemas in database citibike
    limit 10000
2020-10-20 03:27:30.565279 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-20 03:27:31.307736 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/usr/local/lib/python3.6/dist-packages/certifi/cacert.pem'>
2020-10-20 03:27:31.565249 (Thread-7): handling poll request
2020-10-20 03:27:31.565754 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100bd518>]}
2020-10-20 03:27:31.568414 (Thread-7): sending response (<Response 5482 bytes [200 OK]>) to 10.0.44.214
2020-10-20 03:27:32.262503 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.70 seconds
2020-10-20 03:27:32.266415 (ThreadPoolExecutor-0_0): On list_citibike: Close
2020-10-20 03:27:32.742396 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_citibike_dbt_aeldridge".
2020-10-20 03:27:32.750262 (ThreadPoolExecutor-1_0): Using snowflake connection "list_citibike_dbt_aeldridge".
2020-10-20 03:27:32.750360 (ThreadPoolExecutor-1_0): On list_citibike_dbt_aeldridge: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_citibike_dbt_aeldridge"} */

    show terse objects in citibike.dbt_aeldridge
2020-10-20 03:27:32.750421 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-10-20 03:27:32.995571 (Thread-8): handling poll request
2020-10-20 03:27:32.996065 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100c6438>]}
2020-10-20 03:27:32.997842 (Thread-8): sending response (<Response 2239 bytes [200 OK]>) to 10.0.47.166
2020-10-20 03:27:34.065546 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.32 seconds
2020-10-20 03:27:34.069918 (ThreadPoolExecutor-1_0): On list_citibike_dbt_aeldridge: Close
2020-10-20 03:27:34.410583 (Thread-9): handling poll request
2020-10-20 03:27:34.413014 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100c6ac8>]}
2020-10-20 03:27:34.414227 (Thread-9): sending response (<Response 847 bytes [200 OK]>) to 10.0.5.27
2020-10-20 03:27:34.576444 (MainThread): Using snowflake connection "master".
2020-10-20 03:27:34.576578 (MainThread): On master: BEGIN
2020-10-20 03:27:34.576641 (MainThread): Opening a new connection, currently in state init
2020-10-20 03:27:35.895349 (Thread-10): handling poll request
2020-10-20 03:27:35.895873 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100c6208>]}
2020-10-20 03:27:35.897248 (Thread-10): sending response (<Response 1085 bytes [200 OK]>) to 10.0.22.169
2020-10-20 03:27:35.930371 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2020-10-20 03:27:35.930533 (MainThread): On master: COMMIT
2020-10-20 03:27:35.930632 (MainThread): Using snowflake connection "master".
2020-10-20 03:27:35.930685 (MainThread): On master: COMMIT
2020-10-20 03:27:36.286309 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-10-20 03:27:36.286510 (MainThread): On master: Close
2020-10-20 03:27:36.750284 (MainThread): 03:27:36 | Concurrency: 1 threads (target='default')
2020-10-20 03:27:36.750434 (MainThread): 03:27:36 | 
2020-10-20 03:27:36.751633 (Thread-1): Began running node model.citibike.gbfs_json
2020-10-20 03:27:36.752942 (Thread-1): 03:27:36 | 1 of 4 START table model dbt_aeldridge.gbfs_json..................... [RUN]
2020-10-20 03:27:36.753260 (Thread-1): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:27:36.753368 (Thread-1): Compiling model.citibike.gbfs_json
2020-10-20 03:27:36.768147 (Thread-1): Writing injected SQL for node "model.citibike.gbfs_json"
2020-10-20 03:27:36.806579 (Thread-1): finished collecting timing info
2020-10-20 03:27:36.836321 (Thread-1): Writing runtime SQL for node "model.citibike.gbfs_json"
2020-10-20 03:27:36.883631 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:27:36.883758 (Thread-1): On model.citibike.gbfs_json: BEGIN
2020-10-20 03:27:36.883822 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 03:27:37.332969 (Thread-11): handling poll request
2020-10-20 03:27:37.333481 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033e320>]}
2020-10-20 03:27:37.336201 (Thread-11): sending response (<Response 6073 bytes [200 OK]>) to 10.0.7.71
2020-10-20 03:27:38.261118 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2020-10-20 03:27:38.261317 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:27:38.261404 (Thread-1): On model.citibike.gbfs_json: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.gbfs_json"} */


      create or replace transient table citibike.dbt_aeldridge.gbfs_json  as
      (--- 
--- get the source data from the GBFS web feeds
---

select $1 data,
    $2 url, citibike.utils.fetch_http_data($2) payload,
    current_timestamp() row_inserted
from (values
    ('regions', 'https://gbfs.citibikenyc.com/gbfs/en/system_regions.json'),
    ('stations', 'https://gbfs.citibikenyc.com/gbfs/en/station_information.json'),
    ('neighborhoods', 'https://snowflake-demo-stuff.s3.amazonaws.com/neighborhoods.geojson'))
      );
2020-10-20 03:27:38.728810 (Thread-12): handling poll request
2020-10-20 03:27:38.729342 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103379e8>]}
2020-10-20 03:27:38.730647 (Thread-12): sending response (<Response 1917 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:40.173563 (Thread-13): handling poll request
2020-10-20 03:27:40.176259 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10337f98>]}
2020-10-20 03:27:40.177310 (Thread-13): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.16
2020-10-20 03:27:41.636003 (Thread-14): handling poll request
2020-10-20 03:27:41.636513 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10337eb8>]}
2020-10-20 03:27:41.637555 (Thread-14): sending response (<Response 286 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:43.184928 (Thread-15): handling poll request
2020-10-20 03:27:43.185454 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a5f8>]}
2020-10-20 03:27:43.186479 (Thread-15): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.145
2020-10-20 03:27:44.613239 (Thread-16): handling poll request
2020-10-20 03:27:44.613786 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a390>]}
2020-10-20 03:27:44.614767 (Thread-16): sending response (<Response 286 bytes [200 OK]>) to 10.0.44.214
2020-10-20 03:27:46.143967 (Thread-17): handling poll request
2020-10-20 03:27:46.144472 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a588>]}
2020-10-20 03:27:46.145549 (Thread-17): sending response (<Response 286 bytes [200 OK]>) to 10.0.44.214
2020-10-20 03:27:47.539407 (Thread-18): handling poll request
2020-10-20 03:27:47.539947 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a588>]}
2020-10-20 03:27:47.540917 (Thread-18): sending response (<Response 285 bytes [200 OK]>) to 10.0.24.16
2020-10-20 03:27:49.103566 (Thread-19): handling poll request
2020-10-20 03:27:49.104064 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033ce48>]}
2020-10-20 03:27:49.105072 (Thread-19): sending response (<Response 286 bytes [200 OK]>) to 10.0.47.166
2020-10-20 03:27:50.546726 (Thread-1): SQL status: SUCCESS 1 in 12.29 seconds
2020-10-20 03:27:50.547993 (Thread-1): On model.citibike.gbfs_json: COMMIT
2020-10-20 03:27:50.548137 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:27:50.548190 (Thread-1): On model.citibike.gbfs_json: COMMIT
2020-10-20 03:27:50.564087 (Thread-20): handling poll request
2020-10-20 03:27:50.564556 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10342550>]}
2020-10-20 03:27:50.565967 (Thread-20): sending response (<Response 1531 bytes [200 OK]>) to 10.0.7.71
2020-10-20 03:27:50.807428 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 03:27:50.819644 (Thread-1): finished collecting timing info
2020-10-20 03:27:50.819957 (Thread-1): On model.citibike.gbfs_json: Close
2020-10-20 03:27:51.294739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae7afd13-aaaf-4c37-b5bc-43a9f9784b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12abaf82b0>]}
2020-10-20 03:27:51.296046 (Thread-1): 03:27:51 | 1 of 4 OK created table model dbt_aeldridge.gbfs_json................ [SUCCESS 1 in 14.54s]
2020-10-20 03:27:51.296168 (Thread-1): Finished running node model.citibike.gbfs_json
2020-10-20 03:27:51.296299 (Thread-1): Began running node model.citibike.weather_vw
2020-10-20 03:27:51.296566 (Thread-1): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 03:27:51.296651 (Thread-1): Compiling model.citibike.weather_vw
2020-10-20 03:27:51.305980 (Thread-1): Writing injected SQL for node "model.citibike.weather_vw"
2020-10-20 03:27:51.326386 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.326836 (Thread-1): Finished running node model.citibike.weather_vw
2020-10-20 03:27:51.326954 (Thread-1): Began running node model.citibike.nhood_json
2020-10-20 03:27:51.327162 (Thread-1): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 03:27:51.327238 (Thread-1): Compiling model.citibike.nhood_json
2020-10-20 03:27:51.337342 (Thread-1): Writing injected SQL for node "model.citibike.nhood_json"
2020-10-20 03:27:51.349637 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.350069 (Thread-1): Finished running node model.citibike.nhood_json
2020-10-20 03:27:51.350184 (Thread-1): Began running node model.citibike.region_json
2020-10-20 03:27:51.350389 (Thread-1): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 03:27:51.350462 (Thread-1): Compiling model.citibike.region_json
2020-10-20 03:27:51.359329 (Thread-1): Writing injected SQL for node "model.citibike.region_json"
2020-10-20 03:27:51.371908 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.372335 (Thread-1): Finished running node model.citibike.region_json
2020-10-20 03:27:51.372450 (Thread-1): Began running node model.citibike.station_json
2020-10-20 03:27:51.372669 (Thread-1): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 03:27:51.372743 (Thread-1): Compiling model.citibike.station_json
2020-10-20 03:27:51.381627 (Thread-1): Writing injected SQL for node "model.citibike.station_json"
2020-10-20 03:27:51.394456 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.394893 (Thread-1): Finished running node model.citibike.station_json
2020-10-20 03:27:51.395329 (Thread-1): Began running node model.citibike.station_nhood_json
2020-10-20 03:27:51.395559 (Thread-1): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 03:27:51.395635 (Thread-1): Compiling model.citibike.station_nhood_json
2020-10-20 03:27:51.407587 (Thread-1): Writing injected SQL for node "model.citibike.station_nhood_json"
2020-10-20 03:27:51.419882 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.420317 (Thread-1): Finished running node model.citibike.station_nhood_json
2020-10-20 03:27:51.420798 (Thread-1): Began running node model.citibike.stations
2020-10-20 03:27:51.421835 (Thread-1): 03:27:51 | 2 of 4 START table model dbt_aeldridge.stations...................... [RUN]
2020-10-20 03:27:51.422065 (Thread-1): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 03:27:51.422138 (Thread-1): Compiling model.citibike.stations
2020-10-20 03:27:51.440245 (Thread-1): Writing injected SQL for node "model.citibike.stations"
2020-10-20 03:27:51.459268 (Thread-1): finished collecting timing info
2020-10-20 03:27:51.463859 (Thread-1): Writing runtime SQL for node "model.citibike.stations"
2020-10-20 03:27:51.485790 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 03:27:51.485875 (Thread-1): On model.citibike.stations: BEGIN
2020-10-20 03:27:51.485935 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 03:27:51.959412 (Thread-21): handling poll request
2020-10-20 03:27:51.959930 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1030fa20>]}
2020-10-20 03:27:51.965389 (Thread-21): sending response (<Response 18985 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:53.363521 (Thread-22): handling poll request
2020-10-20 03:27:53.365970 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a080>]}
2020-10-20 03:27:53.366959 (Thread-22): sending response (<Response 286 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:53.368147 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2020-10-20 03:27:53.368309 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 03:27:53.368370 (Thread-1): On model.citibike.stations: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.stations"} */


      create or replace transient table citibike.dbt_aeldridge.stations  as
      (--- 
--- materialise the station records augmented with neighborhood data
---

with  __dbt__CTE__station_json as (


--
-- get the station data in JSON format
--

with s as (
    select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'stations'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value station_v,
         payload:response.last_updated::timestamp last_updated,
         row_inserted
from s, lateral flatten (input => payload:response.data.stations)
),  __dbt__CTE__nhood_json as (


--
-- get the neighborhood data in JSON format
--

with n as (
    select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'neighborhoods'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value neighborhood_v,
    to_geography(value:geometry) geo,
    value:properties.borough::string borough,
    value:properties.neighborhood::string neighborhood
from n, lateral flatten (input => payload:response.features)
),  __dbt__CTE__station_nhood_json as (


---
--- augment the station records with the neighborhood they are in
---

select station_v,
    last_updated,
    row_inserted,
    st_point(station_v:lon::float, station_v:lat::float) station_geo,
    borough borough_name,
    neighborhood neighborhood_name
from __dbt__CTE__station_json inner join __dbt__CTE__nhood_json
where st_within(station_geo, geo)
),  __dbt__CTE__region_json as (


--
-- get the region data in JSON format
--

with r as (
  select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'regions'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value region_v,
         payload:response.last_updated::timestamp last_updated,
         row_inserted
from r, lateral flatten (input => payload:response.data.regions)
),s as (
    select * from __dbt__CTE__station_nhood_json
      where row_inserted = (select max(row_inserted) from __dbt__CTE__station_json)),
r as (
    select * from __dbt__CTE__region_json
      where row_inserted = (select max(row_inserted) from __dbt__CTE__region_json))
select station_v:station_id::number station_id,
    station_v:name::string station_name,
    station_v:lat::float station_lat,
    station_v:lon::float station_lon,
    station_geo,
    station_v:station_type::string station_type,
    station_v:capacity::number station_capacity,
    station_v:rental_methods rental_methods,
    region_v:name::string region_name,
    borough_name, neighborhood_name
from s left outer join r
    on station_v:region_id::integer = region_v:region_id::integer
      );
2020-10-20 03:27:54.777197 (Thread-23): handling poll request
2020-10-20 03:27:54.777807 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a780>]}
2020-10-20 03:27:54.779295 (Thread-23): sending response (<Response 4237 bytes [200 OK]>) to 10.0.1.193
2020-10-20 03:27:56.203124 (Thread-24): handling poll request
2020-10-20 03:27:56.203625 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033ecf8>]}
2020-10-20 03:27:56.204615 (Thread-24): sending response (<Response 286 bytes [200 OK]>) to 10.0.1.86
2020-10-20 03:27:56.693302 (Thread-1): SQL status: SUCCESS 1 in 3.32 seconds
2020-10-20 03:27:56.694437 (Thread-1): On model.citibike.stations: COMMIT
2020-10-20 03:27:56.694566 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 03:27:56.694619 (Thread-1): On model.citibike.stations: COMMIT
2020-10-20 03:27:56.956750 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 03:27:56.959129 (Thread-1): finished collecting timing info
2020-10-20 03:27:56.959415 (Thread-1): On model.citibike.stations: Close
2020-10-20 03:27:57.427418 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae7afd13-aaaf-4c37-b5bc-43a9f9784b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a84a6320>]}
2020-10-20 03:27:57.428695 (Thread-1): 03:27:57 | 2 of 4 OK created table model dbt_aeldridge.stations................. [SUCCESS 1 in 6.01s]
2020-10-20 03:27:57.428809 (Thread-1): Finished running node model.citibike.stations
2020-10-20 03:27:57.429545 (Thread-1): Began running node model.citibike.es
2020-10-20 03:27:57.429834 (Thread-1): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 03:27:57.429923 (Thread-1): Compiling model.citibike.es
2020-10-20 03:27:57.438383 (Thread-1): Writing injected SQL for node "model.citibike.es"
2020-10-20 03:27:57.451061 (Thread-1): finished collecting timing info
2020-10-20 03:27:57.451500 (Thread-1): Finished running node model.citibike.es
2020-10-20 03:27:57.451616 (Thread-1): Began running node model.citibike.ss
2020-10-20 03:27:57.451821 (Thread-1): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 03:27:57.451893 (Thread-1): Compiling model.citibike.ss
2020-10-20 03:27:57.459780 (Thread-1): Writing injected SQL for node "model.citibike.ss"
2020-10-20 03:27:57.470430 (Thread-1): finished collecting timing info
2020-10-20 03:27:57.470861 (Thread-1): Finished running node model.citibike.ss
2020-10-20 03:27:57.471278 (Thread-1): Began running node model.citibike.trips_stations_vw
2020-10-20 03:27:57.472245 (Thread-1): 03:27:57 | 3 of 4 START view model dbt_aeldridge.trips_stations_vw.............. [RUN]
2020-10-20 03:27:57.472472 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:27:57.472543 (Thread-1): Compiling model.citibike.trips_stations_vw
2020-10-20 03:27:57.485402 (Thread-1): Writing injected SQL for node "model.citibike.trips_stations_vw"
2020-10-20 03:27:57.497031 (Thread-1): finished collecting timing info
2020-10-20 03:27:57.516026 (Thread-1): Writing runtime SQL for node "model.citibike.trips_stations_vw"
2020-10-20 03:27:57.529102 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:27:57.529184 (Thread-1): On model.citibike.trips_stations_vw: BEGIN
2020-10-20 03:27:57.529254 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 03:27:57.608138 (Thread-25): handling poll request
2020-10-20 03:27:57.608555 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1033a208>]}
2020-10-20 03:27:57.612569 (Thread-25): sending response (<Response 12438 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:27:59.035491 (Thread-26): handling poll request
2020-10-20 03:27:59.036014 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103f9d30>]}
2020-10-20 03:27:59.037293 (Thread-26): sending response (<Response 286 bytes [200 OK]>) to 10.0.44.214
2020-10-20 03:27:59.119615 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-10-20 03:27:59.119763 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:27:59.119820 (Thread-1): On model.citibike.trips_stations_vw: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.trips_stations_vw"} */

  create or replace  view citibike.dbt_aeldridge.trips_stations_vw  as (
    

with __dbt__CTE__ss as (


select station_id start_stn_id,
    station_name start_station, region_name start_region,
    borough_name start_borough, neighborhood_name start_neighborhood,
    station_lat start_lat, station_lon start_lon, station_geo start_geo
from citibike.dbt_aeldridge.stations
),  __dbt__CTE__es as (


select station_id end_stn_id,
    station_name end_station, region_name end_region,
    borough_name end_borough, neighborhood_name end_neighborhood,
    station_lat end_lat, station_lon end_lon, station_geo end_geo
from citibike.dbt_aeldridge.stations
)--
-- trip data enhanced with station location data
--

select *
from citibike.demo.trips t
     left outer join __dbt__CTE__ss ss  on t.start_station_id = ss.start_stn_id
     left outer join __dbt__CTE__es es  on t.end_station_id = es.end_stn_id
  );
2020-10-20 03:27:59.597478 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-10-20 03:27:59.598579 (Thread-1): On model.citibike.trips_stations_vw: COMMIT
2020-10-20 03:27:59.598710 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:27:59.598764 (Thread-1): On model.citibike.trips_stations_vw: COMMIT
2020-10-20 03:27:59.856882 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 03:27:59.860567 (Thread-1): finished collecting timing info
2020-10-20 03:27:59.860839 (Thread-1): On model.citibike.trips_stations_vw: Close
2020-10-20 03:28:00.326364 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae7afd13-aaaf-4c37-b5bc-43a9f9784b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a842c898>]}
2020-10-20 03:28:00.327668 (Thread-1): 03:28:00 | 3 of 4 OK created view model dbt_aeldridge.trips_stations_vw......... [SUCCESS 1 in 2.85s]
2020-10-20 03:28:00.327784 (Thread-1): Finished running node model.citibike.trips_stations_vw
2020-10-20 03:28:00.328498 (Thread-1): Began running node model.citibike.trips_stations_weather_vw
2020-10-20 03:28:00.329528 (Thread-1): 03:28:00 | 4 of 4 START view model dbt_aeldridge.trips_stations_weather_vw...... [RUN]
2020-10-20 03:28:00.329788 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:28:00.329870 (Thread-1): Compiling model.citibike.trips_stations_weather_vw
2020-10-20 03:28:00.341195 (Thread-1): Writing injected SQL for node "model.citibike.trips_stations_weather_vw"
2020-10-20 03:28:00.354249 (Thread-1): finished collecting timing info
2020-10-20 03:28:00.358916 (Thread-1): Writing runtime SQL for node "model.citibike.trips_stations_weather_vw"
2020-10-20 03:28:00.373587 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:28:00.373665 (Thread-1): On model.citibike.trips_stations_weather_vw: BEGIN
2020-10-20 03:28:00.373725 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 03:28:00.480682 (Thread-27): handling poll request
2020-10-20 03:28:00.481175 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10360400>]}
2020-10-20 03:28:00.484593 (Thread-27): sending response (<Response 10092 bytes [200 OK]>) to 10.0.33.145
2020-10-20 03:28:01.904224 (Thread-28): handling poll request
2020-10-20 03:28:01.904729 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100c6630>]}
2020-10-20 03:28:01.905742 (Thread-28): sending response (<Response 286 bytes [200 OK]>) to 10.0.21.85
2020-10-20 03:28:01.934554 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2020-10-20 03:28:01.934707 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:28:01.934763 (Thread-1): On model.citibike.trips_stations_weather_vw: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.trips_stations_weather_vw"} */

  create or replace  view citibike.dbt_aeldridge.trips_stations_weather_vw  as (
    

with __dbt__CTE__weather_vw as (


--
-- extracting/calculating the attributes from the weather JSON
--

select v:city.id::int                              city_id
    ,date_trunc('hour', t)                         observation_time
    ,utils.degKtoC(avg(v:main.temp::float))        temp_avg_c
    ,utils.degKtoF(avg(v:main.temp::float))        temp_avg_f
    ,truncate(avg(v:wind.deg::float))              wind_dir
    ,truncate(avg(v:wind.speed::float), 1)         wind_speed_mph
    ,truncate(avg(v:wind.speed::float) * 1.61, 1)  wind_speed_kph
from citibike.demo.weather
group by 1, 2
)--
-- connecting the trip and the weather data together
--

select *
from citibike.dbt_aeldridge.trips_stations_vw 
    left outer join __dbt__CTE__weather_vw on date_trunc('hour', starttime) = observation_time
where city_id = 5128638
  );
2020-10-20 03:28:02.502383 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2020-10-20 03:28:02.503503 (Thread-1): On model.citibike.trips_stations_weather_vw: COMMIT
2020-10-20 03:28:02.503632 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:28:02.503686 (Thread-1): On model.citibike.trips_stations_weather_vw: COMMIT
2020-10-20 03:28:02.762378 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 03:28:02.766042 (Thread-1): finished collecting timing info
2020-10-20 03:28:02.766319 (Thread-1): On model.citibike.trips_stations_weather_vw: Close
2020-10-20 03:28:03.253254 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae7afd13-aaaf-4c37-b5bc-43a9f9784b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aa385be0>]}
2020-10-20 03:28:03.254516 (Thread-1): 03:28:03 | 4 of 4 OK created view model dbt_aeldridge.trips_stations_weather_vw. [SUCCESS 1 in 2.92s]
2020-10-20 03:28:03.254629 (Thread-1): Finished running node model.citibike.trips_stations_weather_vw
2020-10-20 03:28:03.317688 (Thread-29): handling poll request
2020-10-20 03:28:03.318320 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b100bd1d0>]}
2020-10-20 03:28:03.321766 (Thread-29): sending response (<Response 6222 bytes [200 OK]>) to 10.0.5.27
2020-10-20 03:28:03.324111 (MainThread): Acquiring new snowflake connection "master".
2020-10-20 03:28:03.324444 (MainThread): Using snowflake connection "master".
2020-10-20 03:28:03.324509 (MainThread): On master: BEGIN
2020-10-20 03:28:03.324566 (MainThread): Opening a new connection, currently in state closed
2020-10-20 03:28:04.682951 (MainThread): SQL status: SUCCESS 1 in 1.36 seconds
2020-10-20 03:28:04.683119 (MainThread): On master: COMMIT
2020-10-20 03:28:04.683219 (MainThread): Using snowflake connection "master".
2020-10-20 03:28:04.683272 (MainThread): On master: COMMIT
2020-10-20 03:28:04.748171 (Thread-30): handling poll request
2020-10-20 03:28:04.748675 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10360b00>]}
2020-10-20 03:28:04.750717 (Thread-30): Checking header 'user-agent' tracing in whitelist set(), 44 additional messages skipped
2020-10-20 03:28:04.913517 (Thread-30): writing 1 spans (enabled:True), 77 additional messages skipped
2020-10-20 03:28:04.913884 (Thread-30): 
      name requests.request
        id 5246717525167721382
  trace_id 3329732935383538413
 parent_id None
   service requests
  resource requests.request
      type http
     start 1603164484.750241
       end 1603164484.913294
  duration 0.163053s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:76f7a1a50f7440e48c3c599e8ff5d332, 97 additional messages skipped
2020-10-20 03:28:04.917774 (Thread-30): sending response (<Response 2408 bytes [200 OK]>) to 10.0.5.27
2020-10-20 03:28:05.024526 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-10-20 03:28:05.024700 (MainThread): On master: Close
2020-10-20 03:28:05.447879 (AgentWriter): reported 1 traces in 0.00473s, 2 additional messages skipped
2020-10-20 03:28:05.448143 (AgentWriter): initialized RateSampler, sample 100% of traces, 95 additional messages skipped
2020-10-20 03:28:05.486660 (MainThread): 03:28:05 | 
2020-10-20 03:28:05.486798 (MainThread): 03:28:05 | Finished running 2 table models, 2 view models in 34.94s.
2020-10-20 03:28:05.486859 (MainThread): Connection 'master' was properly closed.
2020-10-20 03:28:05.486902 (MainThread): Connection 'model.citibike.trips_stations_weather_vw' was properly closed.
2020-10-20 03:28:05.523623 (MainThread): 
2020-10-20 03:28:05.523754 (MainThread): Completed successfully
2020-10-20 03:28:05.523831 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-20 03:28:06.346470 (Thread-31): handling poll request
2020-10-20 03:28:06.346988 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1037eb70>]}
2020-10-20 03:28:06.361872 (Thread-31): sending response (<Response 22411 bytes [200 OK]>) to 10.0.5.27
2020-10-20 03:28:06.779510 (Thread-32): handling status request
2020-10-20 03:28:06.780062 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b3f3588>]}
2020-10-20 03:28:06.784899 (Thread-32): sending response (<Response 11345 bytes [200 OK]>) to 10.0.29.170
2020-10-20 03:28:48.075714 (Thread-33): handling status request
2020-10-20 03:28:48.076231 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b38e048>]}
2020-10-20 03:28:48.080782 (Thread-33): sending response (<Response 11345 bytes [200 OK]>) to 10.0.8.193
2020-10-20 03:28:55.047190 (Thread-34): Parsing macros/adapters.sql
2020-10-20 03:28:55.077035 (Thread-34): Parsing macros/catalog.sql
2020-10-20 03:28:55.079130 (Thread-34): Parsing macros/materializations/table.sql
2020-10-20 03:28:55.083244 (Thread-34): Parsing macros/materializations/merge.sql
2020-10-20 03:28:55.085357 (Thread-34): Parsing macros/materializations/view.sql
2020-10-20 03:28:55.086900 (Thread-34): Parsing macros/materializations/incremental.sql
2020-10-20 03:28:55.097360 (Thread-34): Parsing macros/core.sql
2020-10-20 03:28:55.101174 (Thread-34): Parsing macros/adapters/common.sql
2020-10-20 03:28:55.145344 (Thread-34): Parsing macros/materializations/helpers.sql
2020-10-20 03:28:55.154630 (Thread-34): Parsing macros/materializations/table/table.sql
2020-10-20 03:28:55.162113 (Thread-34): Parsing macros/materializations/seed/seed.sql
2020-10-20 03:28:55.183497 (Thread-34): Parsing macros/materializations/view/view.sql
2020-10-20 03:28:55.189932 (Thread-34): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 03:28:55.195094 (Thread-34): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 03:28:55.197036 (Thread-34): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 03:28:55.203466 (Thread-34): Parsing macros/materializations/common/merge.sql
2020-10-20 03:28:55.217853 (Thread-34): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 03:28:55.234883 (Thread-34): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 03:28:55.236732 (Thread-34): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 03:28:55.265799 (Thread-34): Parsing macros/schema_tests/relationships.sql
2020-10-20 03:28:55.267852 (Thread-34): Parsing macros/schema_tests/not_null.sql
2020-10-20 03:28:55.269846 (Thread-34): Parsing macros/schema_tests/unique.sql
2020-10-20 03:28:55.271995 (Thread-34): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 03:28:55.276032 (Thread-34): Parsing macros/etc/get_custom_database.sql
2020-10-20 03:28:55.278542 (Thread-34): Parsing macros/etc/query.sql
2020-10-20 03:28:55.279930 (Thread-34): Parsing macros/etc/datetime.sql
2020-10-20 03:28:55.293102 (Thread-34): Parsing macros/etc/get_custom_alias.sql
2020-10-20 03:28:55.294685 (Thread-34): Parsing macros/etc/is_incremental.sql
2020-10-20 03:28:55.297221 (Thread-34): Parsing macros/etc/get_custom_schema.sql
2020-10-20 03:28:55.357176 (Thread-34): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 03:28:55.376795 (Thread-34): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 03:28:55.396887 (Thread-34): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 03:28:55.410870 (Thread-35): handling status request
2020-10-20 03:28:55.411247 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b259710>]}
2020-10-20 03:28:55.411941 (Thread-35): sending response (<Response 184 bytes [200 OK]>) to 10.0.8.193
2020-10-20 03:28:55.417635 (Thread-34): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 03:28:55.438738 (Thread-34): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 03:28:55.460188 (Thread-34): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 03:28:55.488327 (Thread-34): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 03:28:55.513362 (Thread-34): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 03:28:55.530428 (Thread-34): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 03:28:55.549750 (Thread-34): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 03:28:55.568028 (Thread-34): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 03:28:56.846618 (Thread-36): handling status request
2020-10-20 03:28:56.847183 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103c4c50>]}
2020-10-20 03:28:56.851793 (Thread-36): sending response (<Response 11385 bytes [200 OK]>) to 10.0.46.73
2020-10-20 04:12:45.220238 (Thread-37): handling status request
2020-10-20 04:12:45.220942 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103baa90>]}
2020-10-20 04:12:45.225787 (Thread-37): sending response (<Response 11385 bytes [200 OK]>) to 10.0.7.71
2020-10-20 04:13:14.082014 (Thread-38): handling status request
2020-10-20 04:13:14.082515 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103a4828>]}
2020-10-20 04:13:14.087329 (Thread-38): sending response (<Response 11385 bytes [200 OK]>) to 10.0.7.71
2020-10-20 04:13:32.716490 (Thread-39): handling status request
2020-10-20 04:13:32.717098 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10357358>]}
2020-10-20 04:13:32.721774 (Thread-39): sending response (<Response 11385 bytes [200 OK]>) to 10.0.8.193
2020-10-20 04:13:38.810869 (MainThread): writing 1 spans (enabled:True), 51 additional messages skipped
2020-10-20 04:13:38.811092 (MainThread): 
      name jinja2.compile
        id 8153983912707454919
  trace_id 1754251117828123916
 parent_id None
   service None
  resource <memory>
      type template
     start 1603167218.8101912
       end 1603167218.810712
  duration 0.000521s
     error 0
      tags 
           jinja2.template_name:<memory>
           runtime-id:76f7a1a50f7440e48c3c599e8ff5d332, 51 additional messages skipped
2020-10-20 04:13:38.833826 (MainThread): Connection 'model.citibike.nhood_json' was properly closed.
2020-10-20 04:13:38.858671 (AgentWriter): reported 24 traces in 0.01496s, 2 additional messages skipped
2020-10-20 04:13:38.858876 (AgentWriter): initialized RateSampler, sample 100% of traces, 95 additional messages skipped
2020-10-20 04:13:38.865425 (Thread-40): Parsing macros/adapters.sql
2020-10-20 04:13:38.895268 (Thread-40): Parsing macros/catalog.sql
2020-10-20 04:13:38.897336 (Thread-40): Parsing macros/materializations/table.sql
2020-10-20 04:13:38.901396 (Thread-40): Parsing macros/materializations/merge.sql
2020-10-20 04:13:38.903488 (Thread-40): Parsing macros/materializations/view.sql
2020-10-20 04:13:38.905087 (Thread-40): Parsing macros/materializations/incremental.sql
2020-10-20 04:13:38.922920 (Thread-40): Parsing macros/core.sql
2020-10-20 04:13:38.929609 (Thread-40): Parsing macros/adapters/common.sql
2020-10-20 04:13:38.987104 (Thread-40): Parsing macros/materializations/helpers.sql
2020-10-20 04:13:38.996467 (Thread-40): Parsing macros/materializations/table/table.sql
2020-10-20 04:13:39.003874 (Thread-40): Parsing macros/materializations/seed/seed.sql
2020-10-20 04:13:39.031347 (Thread-40): Parsing macros/materializations/view/view.sql
2020-10-20 04:13:39.040044 (Thread-40): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 04:13:39.046878 (Thread-40): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 04:13:39.049281 (Thread-40): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 04:13:39.055724 (Thread-40): Parsing macros/materializations/common/merge.sql
2020-10-20 04:13:39.070203 (Thread-40): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 04:13:39.087572 (Thread-40): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 04:13:39.089458 (Thread-40): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 04:13:39.118723 (Thread-40): Parsing macros/schema_tests/relationships.sql
2020-10-20 04:13:39.120751 (Thread-40): Parsing macros/schema_tests/not_null.sql
2020-10-20 04:13:39.122420 (Thread-40): Parsing macros/schema_tests/unique.sql
2020-10-20 04:13:39.124233 (Thread-40): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 04:13:39.127101 (Thread-40): Parsing macros/etc/get_custom_database.sql
2020-10-20 04:13:39.128865 (Thread-40): Parsing macros/etc/query.sql
2020-10-20 04:13:39.130003 (Thread-40): Parsing macros/etc/datetime.sql
2020-10-20 04:13:39.139340 (Thread-40): Parsing macros/etc/get_custom_alias.sql
2020-10-20 04:13:39.140376 (Thread-40): Parsing macros/etc/is_incremental.sql
2020-10-20 04:13:39.142117 (Thread-40): Parsing macros/etc/get_custom_schema.sql
2020-10-20 04:13:39.191731 (Thread-40): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:13:39.212226 (Thread-40): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 04:13:39.232878 (Thread-40): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:13:39.252245 (Thread-40): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:13:39.268970 (Thread-40): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 04:13:39.280720 (Thread-41): handling status request
2020-10-20 04:13:39.281169 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10519898>]}
2020-10-20 04:13:39.281916 (Thread-41): sending response (<Response 184 bytes [200 OK]>) to 10.0.8.193
2020-10-20 04:13:39.288755 (Thread-40): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 04:13:39.308424 (Thread-40): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 04:13:39.326594 (Thread-40): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 04:13:39.344508 (Thread-40): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 04:13:39.363208 (Thread-40): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 04:13:39.382221 (Thread-40): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 04:13:40.683302 (Thread-42): handling status request
2020-10-20 04:13:40.683858 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1062e160>]}
2020-10-20 04:13:40.688502 (Thread-42): sending response (<Response 11385 bytes [200 OK]>) to 10.0.29.170
2020-10-20 04:14:01.443198 (Thread-43): handling status request
2020-10-20 04:14:01.443694 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b106259b0>]}
2020-10-20 04:14:01.448232 (Thread-43): sending response (<Response 11385 bytes [200 OK]>) to 10.0.7.71
2020-10-20 04:14:01.491537 (Thread-44): handling status request
2020-10-20 04:14:01.492082 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b3208d0>]}
2020-10-20 04:14:01.499062 (Thread-44): sending response (<Response 11385 bytes [200 OK]>) to 10.0.46.73
2020-10-20 04:14:01.911769 (Thread-45): handling cli_args request
2020-10-20 04:14:01.912339 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b325d68>]}
2020-10-20 04:14:01.921389 (Thread-45): Connection 'model.citibike.nhood_json' was properly closed.
2020-10-20 04:14:03.026204 (Thread-45): sending response (<Response 137 bytes [200 OK]>) to 10.0.22.169
2020-10-20 04:14:03.093279 (MainThread): Partial parsing not enabled
2020-10-20 04:14:03.094655 (MainThread): Parsing macros/adapters.sql
2020-10-20 04:14:03.127121 (MainThread): Parsing macros/catalog.sql
2020-10-20 04:14:03.129327 (MainThread): Parsing macros/materializations/table.sql
2020-10-20 04:14:03.133358 (MainThread): Parsing macros/materializations/merge.sql
2020-10-20 04:14:03.135448 (MainThread): Parsing macros/materializations/view.sql
2020-10-20 04:14:03.137021 (MainThread): Parsing macros/materializations/incremental.sql
2020-10-20 04:14:03.148738 (MainThread): Parsing macros/core.sql
2020-10-20 04:14:03.153834 (MainThread): Parsing macros/adapters/common.sql
2020-10-20 04:14:03.201743 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-20 04:14:03.211232 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-20 04:14:03.218380 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-20 04:14:03.239975 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-20 04:14:03.246573 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 04:14:03.252050 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 04:14:03.254119 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 04:14:03.260498 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-20 04:14:03.275169 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 04:14:03.292695 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 04:14:03.294678 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 04:14:03.324214 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-20 04:14:03.326366 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-20 04:14:03.328097 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-20 04:14:03.330033 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 04:14:03.332904 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-20 04:14:03.334773 (MainThread): Parsing macros/etc/query.sql
2020-10-20 04:14:03.335977 (MainThread): Parsing macros/etc/datetime.sql
2020-10-20 04:14:03.345212 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-20 04:14:03.346364 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-20 04:14:03.348170 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-20 04:14:03.359114 (MainThread): Partial parsing not enabled
2020-10-20 04:14:03.409373 (MainThread): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:14:03.439504 (MainThread): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 04:14:03.454398 (Thread-46): handling poll request
2020-10-20 04:14:03.455022 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b2bc080>]}
2020-10-20 04:14:03.462305 (Thread-46): sending response (<Response 9399 bytes [200 OK]>) to 10.0.44.214
2020-10-20 04:14:03.460025 (MainThread): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:14:03.479632 (MainThread): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:14:03.496709 (MainThread): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 04:14:03.514784 (MainThread): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 04:14:03.536393 (MainThread): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 04:14:03.558545 (MainThread): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 04:14:03.576561 (MainThread): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 04:14:03.594592 (MainThread): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 04:14:03.612797 (MainThread): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 04:14:03.921663 (MainThread): Found 11 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources
2020-10-20 04:14:03.923762 (MainThread): 
2020-10-20 04:14:03.924267 (MainThread): Acquiring new snowflake connection "master".
2020-10-20 04:14:03.933968 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_citibike".
2020-10-20 04:14:03.947673 (ThreadPoolExecutor-0_0): Using snowflake connection "list_citibike".
2020-10-20 04:14:03.947772 (ThreadPoolExecutor-0_0): On list_citibike: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_citibike"} */

    show terse schemas in database citibike
    limit 10000
2020-10-20 04:14:03.947834 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-20 04:14:04.829299 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/usr/local/lib/python3.6/dist-packages/certifi/cacert.pem'>
2020-10-20 04:14:04.895456 (Thread-47): handling poll request
2020-10-20 04:14:04.896033 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b1060ed68>]}
2020-10-20 04:14:04.898691 (Thread-47): sending response (<Response 5203 bytes [200 OK]>) to 10.0.20.192
2020-10-20 04:14:06.428164 (Thread-48): handling poll request
2020-10-20 04:14:06.428669 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ae630>]}
2020-10-20 04:14:06.429777 (Thread-48): sending response (<Response 285 bytes [200 OK]>) to 10.0.38.178
2020-10-20 04:14:06.761419 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 2.81 seconds
2020-10-20 04:14:06.765329 (ThreadPoolExecutor-0_0): On list_citibike: Close
2020-10-20 04:14:07.276037 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_citibike_dbt_aeldridge".
2020-10-20 04:14:07.283699 (ThreadPoolExecutor-1_0): Using snowflake connection "list_citibike_dbt_aeldridge".
2020-10-20 04:14:07.283796 (ThreadPoolExecutor-1_0): On list_citibike_dbt_aeldridge: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_citibike_dbt_aeldridge"} */

    show terse objects in citibike.dbt_aeldridge
2020-10-20 04:14:07.283858 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-10-20 04:14:07.866405 (Thread-49): handling poll request
2020-10-20 04:14:07.866899 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ae2b0>]}
2020-10-20 04:14:07.868484 (Thread-49): sending response (<Response 2245 bytes [200 OK]>) to 10.0.47.166
2020-10-20 04:14:09.106017 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.82 seconds
2020-10-20 04:14:09.110327 (ThreadPoolExecutor-1_0): On list_citibike_dbt_aeldridge: Close
2020-10-20 04:14:09.440408 (Thread-50): handling poll request
2020-10-20 04:14:09.440897 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28d940>]}
2020-10-20 04:14:09.442143 (Thread-50): sending response (<Response 849 bytes [200 OK]>) to 10.0.20.192
2020-10-20 04:14:09.628750 (MainThread): Using snowflake connection "master".
2020-10-20 04:14:09.628878 (MainThread): On master: BEGIN
2020-10-20 04:14:09.628940 (MainThread): Opening a new connection, currently in state init
2020-10-20 04:14:10.889543 (Thread-51): handling poll request
2020-10-20 04:14:10.890021 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28da20>]}
2020-10-20 04:14:10.891303 (Thread-51): sending response (<Response 1088 bytes [200 OK]>) to 10.0.38.178
2020-10-20 04:14:11.005180 (MainThread): SQL status: SUCCESS 1 in 1.38 seconds
2020-10-20 04:14:11.005342 (MainThread): On master: COMMIT
2020-10-20 04:14:11.005439 (MainThread): Using snowflake connection "master".
2020-10-20 04:14:11.005491 (MainThread): On master: COMMIT
2020-10-20 04:14:11.528702 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2020-10-20 04:14:11.528874 (MainThread): On master: Close
2020-10-20 04:14:12.047841 (MainThread): 04:14:12 | Concurrency: 1 threads (target='default')
2020-10-20 04:14:12.047993 (MainThread): 04:14:12 | 
2020-10-20 04:14:12.049287 (Thread-1): Began running node model.citibike.gbfs_json
2020-10-20 04:14:12.050627 (Thread-1): 04:14:12 | 1 of 4 START table model dbt_aeldridge.gbfs_json..................... [RUN]
2020-10-20 04:14:12.050934 (Thread-1): Acquiring new snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:14:12.051050 (Thread-1): Compiling model.citibike.gbfs_json
2020-10-20 04:14:12.066936 (Thread-1): Writing injected SQL for node "model.citibike.gbfs_json"
2020-10-20 04:14:12.087935 (Thread-1): finished collecting timing info
2020-10-20 04:14:12.117627 (Thread-1): Writing runtime SQL for node "model.citibike.gbfs_json"
2020-10-20 04:14:12.137966 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:14:12.138070 (Thread-1): On model.citibike.gbfs_json: BEGIN
2020-10-20 04:14:12.138133 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 04:14:12.306744 (Thread-52): handling poll request
2020-10-20 04:14:12.307256 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28dfd0>]}
2020-10-20 04:14:12.310259 (Thread-52): sending response (<Response 6093 bytes [200 OK]>) to 10.0.5.27
2020-10-20 04:14:13.727135 (Thread-53): handling poll request
2020-10-20 04:14:13.727637 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28ddd8>]}
2020-10-20 04:14:13.728647 (Thread-53): sending response (<Response 286 bytes [200 OK]>) to 10.0.22.169
2020-10-20 04:14:13.776841 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2020-10-20 04:14:13.777023 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:14:13.777085 (Thread-1): On model.citibike.gbfs_json: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.gbfs_json"} */


      create or replace transient table citibike.dbt_aeldridge.gbfs_json  as
      (

--- 
--- get the source data from the GBFS web feeds
---

select $1 data,
    $2 url, citibike.utils.fetch_http_data($2) payload,
    current_timestamp() row_inserted
from (values
    ('regions', 'https://gbfs.citibikenyc.com/gbfs/en/system_regions.json'),
    ('stations', 'https://gbfs.citibikenyc.com/gbfs/en/station_information.json'),
    ('neighborhoods', 'https://snowflake-demo-stuff.s3.amazonaws.com/neighborhoods.geojson'))
      );
2020-10-20 04:14:15.138120 (Thread-54): handling poll request
2020-10-20 04:14:15.138617 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28d828>]}
2020-10-20 04:14:15.139934 (Thread-54): sending response (<Response 1924 bytes [200 OK]>) to 10.0.24.16
2020-10-20 04:14:16.657965 (Thread-55): handling poll request
2020-10-20 04:14:16.658464 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ae6a0>]}
2020-10-20 04:14:16.659442 (Thread-55): sending response (<Response 286 bytes [200 OK]>) to 10.0.5.27
2020-10-20 04:14:18.311780 (Thread-56): handling poll request
2020-10-20 04:14:18.312293 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ae6a0>]}
2020-10-20 04:14:18.313325 (Thread-56): sending response (<Response 286 bytes [200 OK]>) to 10.0.29.170
2020-10-20 04:14:19.780815 (Thread-57): handling poll request
2020-10-20 04:14:19.781531 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b30f358>]}
2020-10-20 04:14:19.782903 (Thread-57): sending response (<Response 286 bytes [200 OK]>) to 10.0.22.169
2020-10-20 04:14:21.189851 (Thread-58): handling poll request
2020-10-20 04:14:21.190369 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28b7f0>]}
2020-10-20 04:14:21.191396 (Thread-58): sending response (<Response 286 bytes [200 OK]>) to 10.0.21.85
2020-10-20 04:14:22.624003 (Thread-59): handling poll request
2020-10-20 04:14:22.624503 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103e3390>]}
2020-10-20 04:14:22.625566 (Thread-59): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.145
2020-10-20 04:14:24.110316 (Thread-60): handling poll request
2020-10-20 04:14:24.110822 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ba080>]}
2020-10-20 04:14:24.111817 (Thread-60): sending response (<Response 286 bytes [200 OK]>) to 10.0.1.86
2020-10-20 04:14:25.525706 (Thread-61): handling poll request
2020-10-20 04:14:25.526237 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ba198>]}
2020-10-20 04:14:25.527271 (Thread-61): sending response (<Response 286 bytes [200 OK]>) to 10.0.21.85
2020-10-20 04:14:26.043223 (Thread-1): SQL status: SUCCESS 1 in 12.27 seconds
2020-10-20 04:14:26.044472 (Thread-1): On model.citibike.gbfs_json: COMMIT
2020-10-20 04:14:26.044603 (Thread-1): Using snowflake connection "model.citibike.gbfs_json".
2020-10-20 04:14:26.044656 (Thread-1): On model.citibike.gbfs_json: COMMIT
2020-10-20 04:14:26.309112 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 04:14:26.321067 (Thread-1): finished collecting timing info
2020-10-20 04:14:26.321352 (Thread-1): On model.citibike.gbfs_json: Close
2020-10-20 04:14:26.887855 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59596c09-4fb0-4780-bc53-4425dfc4939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc67bfa20>]}
2020-10-20 04:14:26.889186 (Thread-1): 04:14:26 | 1 of 4 OK created table model dbt_aeldridge.gbfs_json................ [SUCCESS 1 in 14.84s]
2020-10-20 04:14:26.889303 (Thread-1): Finished running node model.citibike.gbfs_json
2020-10-20 04:14:26.889436 (Thread-1): Began running node model.citibike.weather_vw
2020-10-20 04:14:26.889696 (Thread-1): Acquiring new snowflake connection "model.citibike.weather_vw".
2020-10-20 04:14:26.889783 (Thread-1): Compiling model.citibike.weather_vw
2020-10-20 04:14:26.898965 (Thread-1): Writing injected SQL for node "model.citibike.weather_vw"
2020-10-20 04:14:26.919477 (Thread-1): finished collecting timing info
2020-10-20 04:14:26.929240 (Thread-62): handling poll request
2020-10-20 04:14:26.929643 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ba518>]}
2020-10-20 04:14:26.931532 (Thread-62): Checking header 'user-agent' tracing in whitelist set(), 24 additional messages skipped
2020-10-20 04:14:26.919910 (Thread-1): Finished running node model.citibike.weather_vw
2020-10-20 04:14:26.920026 (Thread-1): Began running node model.citibike.nhood_json
2020-10-20 04:14:26.920230 (Thread-1): Acquiring new snowflake connection "model.citibike.nhood_json".
2020-10-20 04:14:26.920304 (Thread-1): Compiling model.citibike.nhood_json
2020-10-20 04:14:26.930375 (Thread-1): Writing injected SQL for node "model.citibike.nhood_json"
2020-10-20 04:14:26.948694 (Thread-1): finished collecting timing info
2020-10-20 04:14:26.949138 (Thread-1): Finished running node model.citibike.nhood_json
2020-10-20 04:14:26.949253 (Thread-1): Began running node model.citibike.region_json
2020-10-20 04:14:26.949455 (Thread-1): Acquiring new snowflake connection "model.citibike.region_json".
2020-10-20 04:14:26.949526 (Thread-1): Compiling model.citibike.region_json
2020-10-20 04:14:26.958332 (Thread-1): Writing injected SQL for node "model.citibike.region_json"
2020-10-20 04:14:26.975888 (Thread-1): finished collecting timing info
2020-10-20 04:14:26.976307 (Thread-1): Finished running node model.citibike.region_json
2020-10-20 04:14:26.976420 (Thread-1): Began running node model.citibike.station_json
2020-10-20 04:14:26.976620 (Thread-1): Acquiring new snowflake connection "model.citibike.station_json".
2020-10-20 04:14:26.976692 (Thread-1): Compiling model.citibike.station_json
2020-10-20 04:14:26.985640 (Thread-1): Writing injected SQL for node "model.citibike.station_json"
2020-10-20 04:14:27.004791 (Thread-1): finished collecting timing info
2020-10-20 04:14:27.005286 (Thread-1): Finished running node model.citibike.station_json
2020-10-20 04:14:27.005838 (Thread-1): Began running node model.citibike.station_nhood_json
2020-10-20 04:14:27.006153 (Thread-1): Acquiring new snowflake connection "model.citibike.station_nhood_json".
2020-10-20 04:14:27.006238 (Thread-1): Compiling model.citibike.station_nhood_json
2020-10-20 04:14:27.018770 (Thread-1): Writing injected SQL for node "model.citibike.station_nhood_json"
2020-10-20 04:14:27.037929 (Thread-1): finished collecting timing info
2020-10-20 04:14:27.038398 (Thread-1): Finished running node model.citibike.station_nhood_json
2020-10-20 04:14:27.038915 (Thread-1): Began running node model.citibike.stations
2020-10-20 04:14:27.039927 (Thread-1): 04:14:27 | 2 of 4 START view model dbt_aeldridge.stations....................... [RUN]
2020-10-20 04:14:27.040161 (Thread-1): Acquiring new snowflake connection "model.citibike.stations".
2020-10-20 04:14:27.055444 (Thread-62): writing 1 spans (enabled:True), 52 additional messages skipped
2020-10-20 04:14:27.055637 (Thread-62): 
      name requests.request
        id 2874016236945127061
  trace_id 12520675655126801920
 parent_id None
   service requests
  resource requests.request
      type http
     start 1603167266.93106
       end 1603167267.0553432
  duration 0.124283s
     error 0
      tags 
           http.method:POST
           http.status_code:200
           http.url:https://fishtownanalytics.sinter-collect.com/com.snowplowanalytics.snowplow/tp2
           runtime-id:76f7a1a50f7440e48c3c599e8ff5d332, 52 additional messages skipped
2020-10-20 04:14:27.040237 (Thread-1): Compiling model.citibike.stations
2020-10-20 04:14:27.062079 (Thread-62): sending response (<Response 18226 bytes [200 OK]>) to 10.0.20.192
2020-10-20 04:14:27.058943 (Thread-1): Writing injected SQL for node "model.citibike.stations"
2020-10-20 04:14:27.079916 (Thread-1): finished collecting timing info
2020-10-20 04:14:27.104073 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 04:14:27.104169 (Thread-1): On model.citibike.stations: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.stations"} */
drop table if exists "CITIBIKE"."DBT_AELDRIDGE"."STATIONS" cascade
2020-10-20 04:14:27.104230 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 04:14:28.014700 (AgentWriter): reported 1 traces in 0.01804s, 1 additional messages skipped
2020-10-20 04:14:28.014947 (AgentWriter): initialized RateSampler, sample 100% of traces, 63 additional messages skipped
2020-10-20 04:14:28.485718 (Thread-63): handling poll request
2020-10-20 04:14:28.486400 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10398e10>]}
2020-10-20 04:14:28.488523 (Thread-63): sending response (<Response 2235 bytes [200 OK]>) to 10.0.21.85
2020-10-20 04:14:28.917540 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2020-10-20 04:14:28.924105 (Thread-1): Writing runtime SQL for node "model.citibike.stations"
2020-10-20 04:14:28.945574 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 04:14:28.945678 (Thread-1): On model.citibike.stations: BEGIN
2020-10-20 04:14:29.405386 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2020-10-20 04:14:29.405527 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 04:14:29.405582 (Thread-1): On model.citibike.stations: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.stations"} */

  create or replace  view citibike.dbt_aeldridge.stations  as (
    

--- 
--- materialise the station records augmented with neighborhood data
---

with  __dbt__CTE__station_json as (


--
-- get the station data in JSON format
--

with s as (
    select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'stations'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value station_v,
         payload:response.last_updated::timestamp last_updated,
         row_inserted
from s, lateral flatten (input => payload:response.data.stations)
),  __dbt__CTE__nhood_json as (


--
-- get the neighborhood data in JSON format
--

with n as (
    select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'neighborhoods'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value neighborhood_v,
    to_geography(value:geometry) geo,
    value:properties.borough::string borough,
    value:properties.neighborhood::string neighborhood
from n, lateral flatten (input => payload:response.features)
),  __dbt__CTE__station_nhood_json as (


---
--- augment the station records with the neighborhood they are in
---

select station_v,
    last_updated,
    row_inserted,
    st_point(station_v:lon::float, station_v:lat::float) station_geo,
    borough borough_name,
    neighborhood neighborhood_name
from __dbt__CTE__station_json inner join __dbt__CTE__nhood_json
where st_within(station_geo, geo)
),  __dbt__CTE__region_json as (


--
-- get the region data in JSON format
--

with r as (
  select payload, row_inserted from citibike.dbt_aeldridge.gbfs_json
      where data = 'regions'
      and row_inserted = (select max(row_inserted) from citibike.dbt_aeldridge.gbfs_json))
select value region_v,
         payload:response.last_updated::timestamp last_updated,
         row_inserted
from r, lateral flatten (input => payload:response.data.regions)
),s as (
    select * from __dbt__CTE__station_nhood_json
      where row_inserted = (select max(row_inserted) from __dbt__CTE__station_json)),
r as (
    select * from __dbt__CTE__region_json
      where row_inserted = (select max(row_inserted) from __dbt__CTE__region_json))
select station_v:station_id::number station_id,
    station_v:name::string station_name,
    station_v:lat::float station_lat,
    station_v:lon::float station_lon,
    station_geo,
    station_v:station_type::string station_type,
    station_v:capacity::number station_capacity,
    station_v:rental_methods rental_methods,
    region_v:name::string region_name,
    borough_name, neighborhood_name
from s left outer join r
    on station_v:region_id::integer = region_v:region_id::integer
  );
2020-10-20 04:14:29.969387 (Thread-64): handling poll request
2020-10-20 04:14:29.970087 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10398128>]}
2020-10-20 04:14:29.972854 (Thread-64): sending response (<Response 5488 bytes [200 OK]>) to 10.0.33.145
2020-10-20 04:14:29.990897 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-10-20 04:14:29.991979 (Thread-1): On model.citibike.stations: COMMIT
2020-10-20 04:14:29.992114 (Thread-1): Using snowflake connection "model.citibike.stations".
2020-10-20 04:14:29.992169 (Thread-1): On model.citibike.stations: COMMIT
2020-10-20 04:14:30.251064 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 04:14:30.254712 (Thread-1): finished collecting timing info
2020-10-20 04:14:30.254982 (Thread-1): On model.citibike.stations: Close
2020-10-20 04:14:30.742159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59596c09-4fb0-4780-bc53-4425dfc4939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc67cd7b8>]}
2020-10-20 04:14:30.743409 (Thread-1): 04:14:30 | 2 of 4 OK created view model dbt_aeldridge.stations.................. [SUCCESS 1 in 3.70s]
2020-10-20 04:14:30.743518 (Thread-1): Finished running node model.citibike.stations
2020-10-20 04:14:30.744288 (Thread-1): Began running node model.citibike.es
2020-10-20 04:14:30.744615 (Thread-1): Acquiring new snowflake connection "model.citibike.es".
2020-10-20 04:14:30.744713 (Thread-1): Compiling model.citibike.es
2020-10-20 04:14:30.753579 (Thread-1): Writing injected SQL for node "model.citibike.es"
2020-10-20 04:14:30.772981 (Thread-1): finished collecting timing info
2020-10-20 04:14:30.773435 (Thread-1): Finished running node model.citibike.es
2020-10-20 04:14:30.773555 (Thread-1): Began running node model.citibike.ss
2020-10-20 04:14:30.773767 (Thread-1): Acquiring new snowflake connection "model.citibike.ss".
2020-10-20 04:14:30.773844 (Thread-1): Compiling model.citibike.ss
2020-10-20 04:14:30.781988 (Thread-1): Writing injected SQL for node "model.citibike.ss"
2020-10-20 04:14:30.801481 (Thread-1): finished collecting timing info
2020-10-20 04:14:30.801931 (Thread-1): Finished running node model.citibike.ss
2020-10-20 04:14:30.802573 (Thread-1): Began running node model.citibike.trips_stations_vw
2020-10-20 04:14:30.803566 (Thread-1): 04:14:30 | 3 of 4 START view model dbt_aeldridge.trips_stations_vw.............. [RUN]
2020-10-20 04:14:30.803799 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:14:30.803874 (Thread-1): Compiling model.citibike.trips_stations_vw
2020-10-20 04:14:30.817540 (Thread-1): Writing injected SQL for node "model.citibike.trips_stations_vw"
2020-10-20 04:14:30.838316 (Thread-1): finished collecting timing info
2020-10-20 04:14:30.842979 (Thread-1): Writing runtime SQL for node "model.citibike.trips_stations_vw"
2020-10-20 04:14:30.871824 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:14:30.871904 (Thread-1): On model.citibike.trips_stations_vw: BEGIN
2020-10-20 04:14:30.871964 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 04:14:31.409381 (Thread-65): handling poll request
2020-10-20 04:14:31.409878 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b28d828>]}
2020-10-20 04:14:31.413984 (Thread-65): sending response (<Response 12470 bytes [200 OK]>) to 10.0.44.214
2020-10-20 04:14:32.823877 (Thread-66): handling poll request
2020-10-20 04:14:32.824418 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10404b38>]}
2020-10-20 04:14:32.825437 (Thread-66): sending response (<Response 286 bytes [200 OK]>) to 10.0.21.85
2020-10-20 04:14:33.930683 (Thread-1): SQL status: SUCCESS 1 in 3.06 seconds
2020-10-20 04:14:33.930842 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:14:33.930899 (Thread-1): On model.citibike.trips_stations_vw: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.trips_stations_vw"} */

  create or replace  view citibike.dbt_aeldridge.trips_stations_vw  as (
    

with __dbt__CTE__ss as (


select station_id start_stn_id,
    station_name start_station, region_name start_region,
    borough_name start_borough, neighborhood_name start_neighborhood,
    station_lat start_lat, station_lon start_lon, station_geo start_geo
from citibike.dbt_aeldridge.stations
),  __dbt__CTE__es as (


select station_id end_stn_id,
    station_name end_station, region_name end_region,
    borough_name end_borough, neighborhood_name end_neighborhood,
    station_lat end_lat, station_lon end_lon, station_geo end_geo
from citibike.dbt_aeldridge.stations
)--
-- trip data enhanced with station location data
--

select *
from citibike.demo.trips t
     left outer join __dbt__CTE__ss ss  on t.start_station_id = ss.start_stn_id
     left outer join __dbt__CTE__es es  on t.end_station_id = es.end_stn_id
  );
2020-10-20 04:14:34.281277 (Thread-67): handling poll request
2020-10-20 04:14:34.281802 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104049e8>]}
2020-10-20 04:14:34.283108 (Thread-67): sending response (<Response 2362 bytes [200 OK]>) to 10.0.1.193
2020-10-20 04:14:34.709493 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2020-10-20 04:14:34.710598 (Thread-1): On model.citibike.trips_stations_vw: COMMIT
2020-10-20 04:14:34.710730 (Thread-1): Using snowflake connection "model.citibike.trips_stations_vw".
2020-10-20 04:14:34.710785 (Thread-1): On model.citibike.trips_stations_vw: COMMIT
2020-10-20 04:14:34.972035 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-10-20 04:14:34.978182 (Thread-1): finished collecting timing info
2020-10-20 04:14:34.978590 (Thread-1): On model.citibike.trips_stations_vw: Close
2020-10-20 04:14:35.468238 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59596c09-4fb0-4780-bc53-4425dfc4939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc6769390>]}
2020-10-20 04:14:35.470175 (Thread-1): 04:14:35 | 3 of 4 OK created view model dbt_aeldridge.trips_stations_vw......... [SUCCESS 1 in 4.66s]
2020-10-20 04:14:35.470330 (Thread-1): Finished running node model.citibike.trips_stations_vw
2020-10-20 04:14:35.471094 (Thread-1): Began running node model.citibike.trips_stations_weather_vw
2020-10-20 04:14:35.472651 (Thread-1): 04:14:35 | 4 of 4 START view model dbt_aeldridge.trips_stations_weather_vw...... [RUN]
2020-10-20 04:14:35.473055 (Thread-1): Acquiring new snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:14:35.473177 (Thread-1): Compiling model.citibike.trips_stations_weather_vw
2020-10-20 04:14:35.491185 (Thread-1): Writing injected SQL for node "model.citibike.trips_stations_weather_vw"
2020-10-20 04:14:35.510351 (Thread-1): finished collecting timing info
2020-10-20 04:14:35.517269 (Thread-1): Writing runtime SQL for node "model.citibike.trips_stations_weather_vw"
2020-10-20 04:14:35.537089 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:14:35.537207 (Thread-1): On model.citibike.trips_stations_weather_vw: BEGIN
2020-10-20 04:14:35.537300 (Thread-1): Opening a new connection, currently in state closed
2020-10-20 04:14:35.756345 (Thread-68): handling poll request
2020-10-20 04:14:35.756855 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104442b0>]}
2020-10-20 04:14:35.759862 (Thread-68): sending response (<Response 8038 bytes [200 OK]>) to 10.0.21.85
2020-10-20 04:14:36.937996 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2020-10-20 04:14:36.938154 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:14:36.938216 (Thread-1): On model.citibike.trips_stations_weather_vw: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.citibike.trips_stations_weather_vw"} */

  create or replace  view citibike.dbt_aeldridge.trips_stations_weather_vw  as (
    

with __dbt__CTE__weather_vw as (


--
-- extracting/calculating the attributes from the weather JSON
--

select v:city.id::int                              city_id
    ,date_trunc('hour', t)                         observation_time
    ,utils.degKtoC(avg(v:main.temp::float))        temp_avg_c
    ,utils.degKtoF(avg(v:main.temp::float))        temp_avg_f
    ,truncate(avg(v:wind.deg::float))              wind_dir
    ,truncate(avg(v:wind.speed::float), 1)         wind_speed_mph
    ,truncate(avg(v:wind.speed::float) * 1.61, 1)  wind_speed_kph
from citibike.demo.weather
group by 1, 2
)--
-- connecting the trip and the weather data together
--

select *
from citibike.dbt_aeldridge.trips_stations_vw 
    left outer join __dbt__CTE__weather_vw on date_trunc('hour', starttime) = observation_time
where city_id = 5128638
  );
2020-10-20 04:14:37.207001 (Thread-69): handling poll request
2020-10-20 04:14:37.207507 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b21c278>]}
2020-10-20 04:14:37.208841 (Thread-69): sending response (<Response 2419 bytes [200 OK]>) to 10.0.38.178
2020-10-20 04:14:38.625552 (Thread-70): handling poll request
2020-10-20 04:14:38.626089 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104ae978>]}
2020-10-20 04:14:38.627484 (Thread-70): sending response (<Response 286 bytes [200 OK]>) to 10.0.20.192
2020-10-20 04:14:38.653050 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2020-10-20 04:14:38.654154 (Thread-1): On model.citibike.trips_stations_weather_vw: COMMIT
2020-10-20 04:14:38.654289 (Thread-1): Using snowflake connection "model.citibike.trips_stations_weather_vw".
2020-10-20 04:14:38.654344 (Thread-1): On model.citibike.trips_stations_weather_vw: COMMIT
2020-10-20 04:14:38.920038 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-10-20 04:14:38.923704 (Thread-1): finished collecting timing info
2020-10-20 04:14:38.923976 (Thread-1): On model.citibike.trips_stations_weather_vw: Close
2020-10-20 04:14:39.404171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59596c09-4fb0-4780-bc53-4425dfc4939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc67c42e8>]}
2020-10-20 04:14:39.405497 (Thread-1): 04:14:39 | 4 of 4 OK created view model dbt_aeldridge.trips_stations_weather_vw. [SUCCESS 1 in 3.93s]
2020-10-20 04:14:39.405615 (Thread-1): Finished running node model.citibike.trips_stations_weather_vw
2020-10-20 04:14:39.408384 (MainThread): Acquiring new snowflake connection "master".
2020-10-20 04:14:39.408546 (MainThread): Using snowflake connection "master".
2020-10-20 04:14:39.408601 (MainThread): On master: BEGIN
2020-10-20 04:14:39.408656 (MainThread): Opening a new connection, currently in state closed
2020-10-20 04:14:40.053527 (Thread-71): handling poll request
2020-10-20 04:14:40.054095 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104446d8>]}
2020-10-20 04:14:40.056854 (Thread-71): sending response (<Response 5187 bytes [200 OK]>) to 10.0.44.214
2020-10-20 04:14:41.026499 (MainThread): SQL status: SUCCESS 1 in 1.62 seconds
2020-10-20 04:14:41.026663 (MainThread): On master: COMMIT
2020-10-20 04:14:41.026762 (MainThread): Using snowflake connection "master".
2020-10-20 04:14:41.026814 (MainThread): On master: COMMIT
2020-10-20 04:14:41.372594 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-10-20 04:14:41.372766 (MainThread): On master: Close
2020-10-20 04:14:41.457312 (Thread-72): handling poll request
2020-10-20 04:14:41.457796 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10516be0>]}
2020-10-20 04:14:41.459411 (Thread-72): sending response (<Response 1850 bytes [200 OK]>) to 10.0.24.16
2020-10-20 04:14:41.843673 (MainThread): 04:14:41 | 
2020-10-20 04:14:41.843808 (MainThread): 04:14:41 | Finished running 1 table model, 3 view models in 37.92s.
2020-10-20 04:14:41.843880 (MainThread): Connection 'master' was properly closed.
2020-10-20 04:14:41.843929 (MainThread): Connection 'model.citibike.trips_stations_weather_vw' was properly closed.
2020-10-20 04:14:41.893926 (MainThread): 
2020-10-20 04:14:41.894067 (MainThread): Completed successfully
2020-10-20 04:14:41.894139 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-20 04:14:42.878324 (Thread-73): handling poll request
2020-10-20 04:14:42.878828 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b10398400>]}
2020-10-20 04:14:42.892990 (Thread-73): sending response (<Response 21939 bytes [200 OK]>) to 10.0.7.71
2020-10-20 04:14:43.330820 (Thread-74): handling status request
2020-10-20 04:14:43.331312 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b103a6ba8>]}
2020-10-20 04:14:43.335951 (Thread-74): sending response (<Response 11385 bytes [200 OK]>) to 10.0.8.193
2020-10-20 04:22:33.907754 (Thread-75): handling status request
2020-10-20 04:22:33.909511 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '618c02c7-e167-4960-b729-ed17fb153774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b104b3cc0>]}
2020-10-20 04:22:33.914223 (Thread-75): sending response (<Response 11385 bytes [200 OK]>) to 10.0.1.86
